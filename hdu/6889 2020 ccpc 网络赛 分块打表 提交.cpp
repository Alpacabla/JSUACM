/*
link: 
tags: 
*/
#include<bits/stdc++.h>
#define to_l(a) ((a)<<1)
#define to_r(a) ((a)<<1|1)
#define lowbit(a) ((a)&(-a))
using namespace std;
typedef long long int ll;
typedef unsigned long long int ull;
const int int_inf=0x3f3f3f3f;
const ll ll_inf=0x3f3f3f3f3f3f3f3f;
const int max_n=1e5+5;
ll sum[]={0,3203324994356,12272577818052,26942805919966,47088408550139,72619548630277,103468900363400,139601928199359,180946446237951,227485624300931,279209790387276,336102842056834,398010087395245,465076136040032,537166405508376,614333144695291,696491836941979,783713993345746,875990973971374,973132625143758,1075207199997334,1182357709860117,1294353294416653,1411359454893926,1533317147057481,1660170771905893,1791887745621005,1928499553076517,2070037758014652,2216411905082806,2367646772295462,2523866600166350,2684731276904017,2850568515870884,3021127003743004,3196703482711201,3376958413069621,3562055899616524,3752170121640034,3946916107520395,4146437503168147,4350713797609466,4559774703609068,4773791241429157,4992380574480394,5215984059716389,5444170553697015,5677213796090295,5915050127319653,6157522951818013,6404774487532576,6656459291988153,6913154895394662,7174611476852485,7440871802567464,7711724083073573,7987442685136053,8267758615241165,8552894678625832,8842685674255565,9137303389808024,9436619750436325,9740394371660823,10049045128993920,10362240272645797,10680189372387880,11002956586881429,11330234145394922,11662231483112904,11998965645219226,12340337443955708,12686473825403158,13036925941489953,13392262072650239,13752278206678610,14116726304047228,14485949887359828,14859851769032722,15238436132857965,15622126205971632,16010026481858292,16402872774962458,16800034584560739,17201728442251765,17608378509778587,18019518580817005,18434940123089657,18855372238489045,19280161081618124,19709431503921553,20143329357815162,20582564936558672,21026363464193702,21473923117873882,21926452565299117,22383876593236984,22845949677423411,23312509002287461,23783220704190493,24259101990397722,24739512092254535,25224373813632750,25713946377217902,26207992824418787,26706754086711123,27209541722648039,27717214454853888,28229941285041851,28746633469521958,29268683359350871,29795030058292249,30325909420256062,30860943104541284,31400361110845705,31944228867615709,32492526353208088,33046298432422938,33604762596372511,34167504798926531,34734183764128590,35305948769039212,35882007747879062,36463125817968834,37047794688673151,37637743962269286,38232425938401255,38831423995263187,39435769460487717,40043602459363978,40656142728840933,41272831981428626,41895354366411614,42521191094232579,43151655002891557,43787311707867845,44427481937478531,45072355983106103,45721274438833860,46374219971298058,47032003347685128,47694811567934920,48361320057757903,49033120405522547,49709152185224625,50389295265403045,51074813235175960,51764393739028434,52458146887383619,53157539231984819,53860855268765418,54569260920066583,55281407190764322,55998032929881003,56719837432633246,57444959050696467,58175194938893999,58910104427451712,59648482584577234,60392539636429632,61140741768689648,61893367909604126,62650580713198340,63411532609492658,64178138379761454,64949487821851696,65724186881400066,66502998128368973,67287233912661258,68076061856016160,68869791015785911,69666709926131678,70469651531118495,71276338909159530,72087286947763761,72902153727155660,73722162212208843,74546987923434241,75375777478591384,76209171112782061,77047078273475859,77890574031485657,78737263845348275,79588083222416712,80443585352169720,81304020375439526,82168230280536613,83037397571998373,83910760214626624,84788864492747774,85671208660856560,86558685854397369,87449888385252216,88345480153813490,89245557277965152,90150383289103865,91059902452946688,91974156813784406,92892130973265086,93815251421286031,94742644961610150,95673602693282040,96611162807637862,97552294636583809,98496351161228856,99446101419800690,100400140238200842,101357604379933818,102320400301626325,103287492085780877,104259323328131247,105235160736446017,106216769704188364,107202508908386545,108190629937919789,109183107045037341,110182313391179758,111185107495098786,112192221158715036,113204629088682721,114219903890568777,115240288380418391,116264584560095788,117293851192104078,118327767436163473,119365825197475152,120408578391415348,121455713456251144,122508577673401387,123565309586840472,124625907112966784,125691092387226313,126759358129814239,127832660548280760,128910758528205087,129993311787175943,131079353900023832,132170632029765200,133266425605302707,134366319002769388,135471017855232224,136579773679267084,137692351919076544,138810101731760732,139932719197291599,141059638781858923,142189584004778627,143325292850665594,144464838590904362,145609821707080546,146758329070018575,147910767168788968,149068486835261111,150230977425625844,151397639230259148,152569077591069304,153744713250999335,154924871327699436,156109530889182861,157298148236796936,158491014727162263,159688630098986232,160888735109394137,162094872050906651,163304801329588149,164519181970704099,165737508762827722,166961333546829995,168188854718038991,169421547921363915,170658554727653317,171899866511374889,173145583369474993,174395816566482114,175648065208169497,176906742260801458,178168570923322497,179435996649277805,180707800605956010,181984902254934543,183265462528106755,184549994330138135,185840215128592977,187134066517584720,188433020790608721,189734504376991772,191041543591686612,192353272828145326,193669696484346041,194989602795271003,196313840517787379,197642104332732214,198975943285110055,200312646429253051,201655385247526775,203001570180938335,204352856524941070,205706601245752904,207066602176989019,208429528322450895,209798173847686107,211169315361937456,212545301100830891,213927062301079547,215311356036294493,216702596645396524,218097169142752452,219496291942274444,220900540670103978,222308748399966736,223720428962088057,225135528480843522,226554651633770820,227980265975676471,229410556751625534,230843054420611435,232281665584253015,233724537513342164,235172243277502647,236622717264700049,238078199166180159,239537799651359346,241003465220194340,242470600379438275,243943463793646109,245420652315372642,246901884585370994,248389683112579277,249877601876373997,251372299190595299,252871665190343163,254374049477890546,255882304767183954,257395872768586555,258912371480900163,260433246589528208,261958081942238181,263485856927023062,265019975733161005,266558620253543110,268101481547363773,269647849971630547,271199310482012493,272755003893137340,274317139418050550,275880069354999013,277449621117053976,279022573983459129,280601576684846226,282182842498076506,283769032314818626,285359564691764650,286955864893414345,288555202924772779,290158855085376392,291767060082602066,293379336778371497,294997580296288451,296618014925158950,298241840768203705,299871483364009242,301504171643287095,303142401890925396,304784538851229546,306433073057733636,308084152180970285,309741717882064136,311400746553528469,313065496541724778,314735368290637247,316406891944176983,318083797343442852,319764859367899060,321452035364656684,323143851712468781,324839167647814963,326537951494675349,328240607613760020,329948908472022658,331660251907259414,333376021941021578,335096261028614203,336821736191268563,338552182636368947,340285226113947256,342023014743570235,343762854073554103,345509046167865761,347261090058488749,349015784003804679,350775754036165140,352538358739519130,354307666537970322,356077598591717080,357853723964160016,359636051826716206,361422121410903588,363211307364886680,365005975761239854,366802889615356492,368605371774958151,370412807102643725,372223502829519324,374037448446222618,375857568116004852,377681177844429276,379509522162110371,381343692551305410,383180624482875100,385020333466232032,386865708078654106,388715762238397392,390570730725202082,392431115398948448,394295334814665740,396162417450701400,398033511801952004,399909713352397493,401787836909180345,403670707103439880,405560360124066978,407453069311034460,409353265601403626,411255048742042878,413160819322419316,415070252669457610,416986178197591001,418903847235591383,420826828938302444,422757483258810145,424689280328267209,426625381373587543,428563023038187300,430509933163735790,432459791723073384,434415822065180754,436372424223640103,438336695051823643,440303125328156731,442275764843964448,444249536424274471,446227329777320759,448211522040791374,450200902369004412,452192955038773189,454188047099980133,456187492338256658,458193517218509026,460201454210706794,462213875212614497,464231209702294801,466256158281531598,468282176489204659,470313903362280400,472349380286542361,474390398971207156,476432607272041893,478480891244239647,480535530035390730,482590367831839377,484650720495084999,486717454783501906,488786900564253131,490859590163437711,492939285361099005,495019443378198107,497107907956781537,499198106484334839,501292747562487145,503393827995557042,505499791101190152,507609198380309812,509719512938381694,511838374418055575,513958251150968668,516083987237445495,518214525179075600,520350806321523199,522486759986576894,524627129232550341,526774546341229230,528925141442346286,531080355828689216,533241682466762066,535403558006716789,537572404408189519,539743575640848965,541920333555624021,544099786176162991,546286646646268634,548477390831149096,550671553012742458,552869910450502241,555070430089767720,557277839235528651,559489356551457210,561704301442537662,563925271202513680,566147281431881001,568376612715641982,570607157098174527,572840944428163514,575083655296819262,577332340284405370,579582680996208147,581835370045993087,584090651710270750,586353229948760304,588617669102650386,590890455968005616,593165977914626293,595443497444503442,597728336491354235,600017789144835907,602310844260506344,604605425003348185,606907246018232449,609213468471490177,611520876748188976,613835855586724775,616153111855458640,618476050430444527,620803653593816129,623133579860626749,625468711304635388,627807248018227566,630152718812293456,632499671837691207,634852531454428480,637206684948489647,639570806919655282,641936280504908825,644302691875745115,646676556845533242,649053270639849595,651433400927973438,653820563526423404,656213591196162595,658606709361118446,661005459940498989,663406926641480500,665813873290601992,668223902279518603,670642695704252427,673061470444582420,675484302683369067,677914650828130180,680350396755660374,682786463373543254,685229291499285599,687673387190686875,690123321044805547,692577455930019932,695034752064660054,697496630254928353,699964666610929621,702434076139250343,704912682594282469,707392545564639005,709878338117957645,712368717059708586,714861586987055751,717358524903939821,719862016870902787,722368567449185532,724877637211028485,727393003731742659,729909757066356462,732435271526043014,734963973600456812,737495087414783479,740029076071836373,742568971434761594,745115068184634503,747660502450618358,750213300645744680,752770789509198412,755330157969062429,757895247875332471,760464419716706717,763036073635651221,765612253647321335,768194769255298115,770781013038364033,773370527859814893,775967055959771317,778564978676384454,781167516176488704,783775957514849235,786390050017257833,789002102098348282,791621295510521090,794248324744431808,796874462104144233,799507924344977661,802145337048088676,804787039774544757,807432533189863650,810081734076330806,812738262080357595,815399501477370449,818062002011808625,820729004452747927,823397834816913163,826072168720985868,828751471923014931,831432059858575890,834121703897917818,836816891838401262,839512721710099810,842214169594312312,844921526781079815,847628392792949766,850341746714293675,853066256677235501,855787808552527340,858515585891419664,861244337891592303,863979598823594835,866720645497049629,869463181043286280,872214691192566630,874965604064258698,877720489602687526,880478418874115257,883245373589329623,886009734219343175,888784345954478162,891558988825015182,894344574392827804,897132598807259756,899924419306443730,902717453085001213,905515706278305685,908316504402095979,911122116662710144,913932711250095844,916744474122670063,919566498638339137,922390521561736307,925217587573063846,928047124587856813,930884264172515552,933721725886788377,936567905191149044,939412986274202202,942268211424453002,945122851927594891,947983231262611516,950850535968935655,953720081249093369,956596560563758113,959476766449355863,962364670395771293,965252786176561126,968146706477503684,971039931561814389,973937536608714326,976842942699339944,979753109865954985,982666215461907556,985587776435275046,988506869143621362,991432531790082361,994362875117494257,997297562377182659,1000234120939338517,1003176947665397417,1006121487817062974,1009073573264039026,1012030374112998428,1014988223343232590,1017952531101669500,1020914578965334377,1023889975329701787,1026862594045000606,1029844823454405239,1032831757058603842,1035819641758024512,1038816198843310540,1041812543270458475,1044812643680403335,1047816222468303409,1050826516675561761,1053842757547223147,1056859548834111053,1059879864807929465,1062906498818378943,1065933347256834859,1068968940482412722,1072004591676965960,1075052333943930742,1078101823574723547,1081152913902831369,1084208057274770397,1087268244613658480,1090331716631679967,1093398453723986149,1096473465674213514,1099550941174553085,1102631284419675345,1105720106635140803,1108806937177428888,1111902844932948141,1115004256079230969,1118104503421838896,1121214680478190173,1124328568816040662,1127443441673951632,1130563920080396683,1133688072740136518,1136816620626555731,1139946430843802617,1143079961719328713,1146225071918331192,1149369794878862920,1152515109609861734,1155667724751554925,1158825512244763463,1161984240855038478,1165149290750399850,1168317299112456671,1171492189721453678,1174668709995170990,1177853019010160209,1181036968862874845,1184229246904635847,1187423739073398783,1190628105333563228,1193830662376602254,1197034926035361558,1200245541997053004,1203462247773685513,1206683212984153284,1209911165896360318,1213143113520730874,1216375846772830611,1219609781187704613,1222853194639748031,1226091912034950643,1229342640610960799,1232600964336312769,1235863112265342996,1239129436102663222,1242393415576124527,1245664719268338726,1248940340413086340,1252221121168243246,1255504132248213761,1258789112848783439,1262081308129594172,1265378739308553437,1268680286436719840,1271985232272398840,1275293448968648310,1278605035937323624,1281920310192713652,1285242441049678986,1288569391869402926,1291894042321384966,1295227528699414932,1298562540475642136,1301902064726673442,1305249033860134139,1308603590673345629,1311957546852986176,1315313808540487432,1318677268972386547,1322046082916570831,1325418017062581249,1328792256961881709,1332171191600264973,1335553254643519529,1338945008415458010,1342337303287949850,1345734206372676764,1349132982171770197,1352538728697041451,1355952618860021946,1359366691325092337,1362784919476137684,1366204523041403064,1369632080726350537,1373062530648265712,1376502572692887112,1379943789591992331,1383388309753828677,1386832303643345771,1390285367856080001,1393737696051889498,1397197799588621799,1400661754994734096,1404137070438801945,1407605034561573434,1411081945401154599,1414563609326372318,1418049128812405034,1421539815082649614,1425033288922274385,1428534667517733011,1432037711224642184,1435543734762318281,1439060500549692480,1442574429411053307,1446092059555975489,1449612835606094431,1453139738635122362,1456671389206801942,1460206656878449023,1463751541907267078,1467294775312665072,1470843859001431285,1474394480953107151,1477951156400279701,1481509640382587004,1485071283291563333,1488642905636299518,1492213475727091804,1495792914491227544,1499369607035950448,1502956199130981839,1506549779442325542,1510149107726574165,1513749528496705401,1517350917949273676,1520959379538843392,1524569128982549417,1528185923504481831,1531806201136450552,1535434399684506601,1539062682154448313,1542691902835967088,1546330778417702099,1549967385239714074,1553609189481359614,1557260695577240491,1560914186609526873,1564572282597689650,1568237650523838591,1571899945765881988,1575569675166121682,1579240675986073158,1582919837368425257,1586601382538972295,1590290108215872868,1593981145129487948,1597672336661951200,1601367053946671662,1605072165395457338,1608776156709739241,1612491254433741870,1616205982487186978,1619925881764185146,1623650674809541847,1627379107943968508,1631111840242214572,1634850825805521204,1638592806715870395,1642340361474049322,1646085379142150541,1649841000251589356,1653599240578582285,1657363360247528037,1661124343181755877,1664895175962526155,1668668731473584416,1672447088778748503,1676227410916844486,1680010914632042442,1683800527520475611,1687592972566003065,1691397705226280306,1695202043811688161,1699009759374873262,1702820559683315484,1706637614734962974,1710453599578417110,1714276549703208563,1718101745557443070,1721933735598579786,1725773930722712233,1729615789373476962,1733460959109007063,1737310081875122113,1741164577779378809,1745023998226041178,1748887530025587666,1752753968449323285,1756621964485331033,1760495146987934500,1764373297738042009,1768256036598345711,1772139979965152230,1776027981562340913,1779926101461421021,1783825576106042406,1787731115921414455,1791638935844957235,1795546807045789394,1799466791960137411,1803385430088263932,1807310307011831228,1811240071336574216,1815177058452629031,1819116370980138098,1823055443320454311,1826998249885678389,1830947334442012623,1834900916380093286,1838858578451610338,1842821509632363008,1846790303624737211,1850755612744011586,1854735156354433981,1858708545538548331,1862694537973722204,1866677935354491154,1870667419600398443,1874656859572708448,1878660803518734659,1882656286928556354,1886661692205349181,1890682041366821584,1894696279983261520,1898720614215076858,1902747831142025394,1906775563583296960,1910809447127461284,1914854016031285425,1918896014759840246,1922945288204818335,1926993938719904352,1931044898494238757,1935105120021738175,1939168451968924957,1943232432408497196,1947300862361414741,1951373824166694231,1955449181127034150,1959531592100560591,1963619295307158018,1967714932253491134,1971808044575984884,1975912533670748820,1980013567270032211,1984125605976686719,1988236873554315058,1992349165939424781,1996471238626017656,2000593470179890062,2004718799507751572,2008852607041741997,2012987947042232213,2017130987343719603,2021279555133874076,2025429196522731419,2029577071275419915,2033735140236806377,2037900984592677471,2042064069368884460,2046237559214705267,2050413053202215969,2054592236923702190,2058776290147165067,2062968882877440041,2067156254289085975,2071347692416231546,2075552387638297016,2079760779022155660,2083969085714720261,2088183939430481831,2092402176868168007,2096626763623632567,2100851418402169550,2105077485358854281,2109312004681886672,2113548213575394328,2117785696506240207,2122033481754598026,2126282585976836517,2130535353290535204,2134793777465307695,2139058744319532222,2143322321073810262,2147590830811570318,2151868713397576011,2156143156103547571,2160426750970406385,2164711583417013720,2169005696809774173,2173300649201224775,2177602274533992986,2181900984868462322,2186207894086780403,2190522966987353519,2194839347482461771,2199157495619586256,2203482971410698099,2207814527893083688,2212141324384390284,2216480355566767725,2220822432581729238};
ll r[]={2,3,5,7,11};
const ll sqn=1e7;
const ll lim=1e10;
bool vis[max_n];
ll pri[max_n];
int tot;
void init(int n)
{
	for(ll i=2;i<=n;i++){
		if(!vis[i]){
			pri[tot++]=i;
			for(ll j=i*i;j<=n;j+=i){
				vis[j]=true;
			}
		}
	}
	return ;
}
ll qpow(ll a,ll b,ll mod)
{
	ll res=1;
	while(b){
		if(b&1) res=res*a%mod;
		a=a*a%mod;
		b>>=1;
	}
	return res;
}
bool is_prime(ll num)
{
	if(num<=2||num%2==0) return num==2;
	int cnt=0;
	ll mod=num;
	num-=1;
	while(num%2==0) num/=2,cnt++;
	for(int i=0;i<5;i++){
		ll a=r[i];
		if(mod==a) continue;
		a=qpow(a,num,mod);
		if(a==1||a==mod-1) continue;
		int j=0;
		for(;j<cnt;j++){
			a=a*a%mod;
			if(a==mod-1) break;
		}
		if(j==cnt) return false;
	}
	return true;
}
ll solve(ll n,ll k)
{
	ll x=n/sqn;
	ll res=sum[x]%k;
	vector<bool> vis(sqn+1);
	ll s=x*sqn+1;
	if(s==1) s++;
	for(int i=0;i<tot;i++){
		ll &p=pri[i];
		ll k=(s+p-1)/pri[i];
		for(k==1?k++:k;1;k++){
			if(k*p>n) break;
			vis[k*p-s]=true;
		}
	}
	for(int i=0;i<=n-s;i++){
		if(!vis[i]) res=(res+i+s)%k;
	}
	// for(ll i=x*sqn+1;i<=n;i++){
	// 	if(is_prime(i)){
	// 		res+=i;
	// 		res%=k;
	// 	}
	// }
	//if(s==1) res--;
	return res;
}
int main()
{
	ios::sync_with_stdio(false);
	cin.tie(0);
	int t;
	init(1e5);
	cin>>t;
	while(t--){
		ll n,k;
		cin>>n>>k;
		if(n==1){
			cout<<0<<endl;
			continue;
		}
		if(n==2){
			cout<<6%k<<endl;
			continue;
		}
		ll res=((n-1)%k)*((n+4)%k)%k*qpow(2,k-2,k)%k;
		//if(n>=1e5) res=(res+24)%k;
		if(n>=2) res=res-2;
		res+=solve(n+1,k);
		res=res%k;
		res=(res+k)%k;
		cout<<res<<endl;
	}
	return 0;
}